<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="website.server.Domain.HealingProgram.HealingService.HealingMessageSharing.Mapper.HealingMessageMapper">

    <!-- 힐링 메시지 생성 -->
    <insert id="create" parameterType="map">
        INSERT INTO healing_message (
            userNumber,
            title,
            imagePath,
            content,
            createdDate,
            likes
        )
        VALUES (
                   #{userNumber},
                   #{title},
                   #{imagePath},
                   #{content},
                   NOW(),
                   0
               )
    </insert>

    <!-- 선택한 힐링 메시지 삭제 -->
    <delete id="delete">
        DELETE FROM healing_message
        WHERE messageId = #{messageId}
    </delete>

    <!-- 힐링 메시지 게시판에서 힐링 메시지 리스트 조회 -->
    <select id="getHealingMessageThumbNail" resultType="website.server.Domain.HealingProgram.HealingService.HealingMessageSharing.DTO.Response.HealingMessageThumbNailResponse">
        SELECT
            hm.messageId AS messageId,
            hm.title AS title,
            m.nickname AS nickname,
            hm.createdDate AS createdDate
        FROM
            healing_message hm
        JOIN
            member m
        ON
            hm.userNumber = m.userNumber
    </select>


    <!-- 힐링 메시지 게시판에서 힐링 메시지 상세 조회 -->
    <select id="getHealingMessage" resultType="website.server.Domain.HealingProgram.HealingService.HealingMessageSharing.DTO.Response.HealingMessageResponse">

        SELECT
            hm.title,
            m.profile_image_path,
            m.nickname,
            hm.createdDate,
            hm.imagePath,
            hm.content
            # hml.like
            # hmc.content

        FROM
            # healing_message_like hml,
            # healing_message_comment hmc,
            healing_message hm
        JOIN

            member m
        ON
            hm.userNumber = m.userNumber
        WHERE
            messageId=#{messageId}

    </select>

</mapper>